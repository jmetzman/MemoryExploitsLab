#include <stdio.h>
#include <stdlib.h>

// Compiled using:
// gcc -O0 -g Memory-in-C-The-Stack-and-The-Heap.c -o \
// Memory-in-C-The-Stack-and-The-Heap

// Run using:
// ./Memory-in-C-The-Stack-and-The-Heap


char* get_name() {
  printf("How many characters long is your name?\n");
  int length;
  scanf("%d", &length);
  length += 1;
  char* name = malloc(length);
  printf("What is your name?\n");
  fflush(0);
  scanf("%s", name);
  return name;
}

void say_hi(char* name) {
  char greeting_format_string[] = {'H', 'i', ' ', '%', 's', '\n'};
  // Notice how name points to memory allocated in get_name()
  printf(greeting_format_string, name);
}

int main() {
  char* name = get_name();
  say_hi(name);
  free(name);
}
